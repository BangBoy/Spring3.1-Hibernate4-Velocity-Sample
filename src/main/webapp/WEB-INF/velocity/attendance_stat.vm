<div class="page_box">
	<div class="content_title">出席統計</div>	
	<hr/>
	<div class="frm_second_title">Summary</div>	
	<table id="tbl_stats" >		
	</table>
	<hr/>
	<div class="frm_second_title">Chart</div>
	<label>
		<input value="1" type="radio" name="r_chart" checked />
		參加次數							
	</label>	
	<label>
		<input value="2" type="radio" name="r_chart"/>
		平均遲到時間						
	</label>
	<label>
		<input value="3" type="radio" name="r_chart"/>
		累計遲到時間						
	</label>
	<div id="chart"></div>
</div>

<script>		
	google.load("visualization", "1", {packages:["corechart"]});    		
	google.setOnLoadCallback(function(){
		var attendanceStats = $attendanceStatJSONList;	
		var chartFunc = function(){
	    	var titleArr = ["dummy","參加次數(次)", "平均遲到時間(分)", "累計遲到時間(分)"];
			var colorArr = ["dummy", "red", "green", "blue"];
	    	var chartSource = [];
			chartSource.push( ['Name','參加次數','平均遲到時間','累計遲到時間']);
			$.each(attendanceStats,function(index,curData){
				chartSource.push([curData.name, curData.count, curData.avglate, curData.sumlate]);
			});
			var options = {
				colors : ["red"],
				vAxis: {
					viewWindow: {min: 0}			       
			      }
			};
			var data = google.visualization.arrayToDataTable(chartSource);
			var view = new google.visualization.DataView(data);
			
			var chart = new google.visualization.ColumnChart(document.getElementById('chart'));     						
			return function(index){
				view.setRows(data.getSortedRows([{column: index,desc: true}]));
				view.setColumns([0,index]);
				options.title = titleArr[index];
				options.colors[0] = colorArr[index]; 
				chart.draw(view,options); 												
			};
	    }();   	   				
		var tblStats = $("#tbl_stats");	
		$(function(){
			chartFunc(1);						
			tblStats.dataTable({
				"aaData": attendanceStats, 
				"aoColumns":[								
					{"sTitle" : "Name" , "mData":"name"},								
					{"sTitle" : "參加次數" , "mData":"count"},
					{"sTitle" : "平均遲到時間(分)" , "mData":"avglate"},
					{"sTitle" : "累計遲到時間(分)" , "mData":"sumlate"}
					
				],
				"bLengthChange" : false,
				"bAutoWidth": true,
				"iDisplayLength": 20,
				"oLanguage":{
					"sInfo": "第_START_至_END_人，總計_TOTAL_人",
					"sInfoFiltered": "全部_MAX_人",
					"sInfoEmpty": "條件內無人員"
				}
			}).fnSort([[1,'desc']]);	;		
		});
		$("input[name=r_chart]").click(function(){		
			chartFunc(parseInt(this.value));						
		});	
		
	    
	    
    });

    
  
    
	
	


</script>